è¿™æ˜¯ä¸€ä¸ªé›†æˆäº† **Excel å¯¼å…¥åŠŸèƒ½** çš„æœ€ç»ˆç‰ˆæœ¬ã€‚

### âœ¨ æ–°å¢åŠŸèƒ½è¯´æ˜
1.  **ä¸€é”®å¯¼å…¥ Excel**ï¼šæ”¯æŒ `.xlsx` æˆ– `.csv` æ–‡ä»¶ã€‚
2.  **æ™ºèƒ½åˆå¹¶ç­–ç•¥**ï¼š
    *   å¦‚æœ Excel é‡Œçš„æ—¥æœŸåœ¨ç°æœ‰è®°å½•ä¸­**å·²å­˜åœ¨** -> **è¦†ç›–**è¯¥æ—¥æœŸçš„ä½“é‡/èŠ±è´¹ï¼ˆä»¥ Excel ä¸ºå‡†ï¼‰ã€‚
    *   å¦‚æœ Excel é‡Œçš„æ—¥æœŸ**ä¸å­˜åœ¨** -> **æ–°å¢**è¿™æ¡è®°å½•ã€‚
3.  **è‡ªåŠ¨äº‘åŒæ­¥**ï¼šå¯¼å…¥å®Œæˆåï¼Œç¨‹åºä¼š**ç«‹å³è‡ªåŠ¨**å°†æœ€æ–°æ•°æ®ä¸Šä¼ è¦†ç›–åˆ° GitHub Gistï¼Œæ— éœ€æ‰‹åŠ¨ä¿å­˜ã€‚

### ğŸ“‹ Excel æ ¼å¼è¦æ±‚
ç¬¬ä¸€è¡Œè¡¨å¤´åŒ…å«ï¼š`æ—¥æœŸ` (æˆ– Date)ã€`ä½“é‡` (æˆ– Weight)ã€‚å¯é€‰ï¼š`èŠ±è´¹`ã€‚

---

### ğŸš€ å®Œæ•´ä»£ç  (å¤åˆ¶ä¿å­˜ä¸º .html)

```html
<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>èº«æåƒè±†äºº (Excelå¢å¼ºç‰ˆ)</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/vue@3/dist/vue.global.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/echarts@5.4.3/dist/echarts.min.js"></script>
    <!-- å¼•å…¥ Excel è§£æåº“ SheetJS -->
    <script src="https://cdn.sheetjs.com/xlsx-0.20.0/package/dist/xlsx.full.min.js"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    
    <style>
        body { font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif; background-color: #0f172a; color: #e2e8f0; }
        [v-cloak] { display: none; }
        
        /* ç»ç’ƒé¢æ¿ */
        .glass {
            background: rgba(30, 41, 59, 0.7);
            backdrop-filter: blur(12px);
            border: 1px solid rgba(255, 255, 255, 0.1);
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.2);
        }

        /* åƒè±†äººåŠ¨ç”» */
        .pac-grid { display: grid; grid-template-columns: repeat(10, 1fr); gap: 6px; max-width: 320px; margin: 0 auto; }
        .pac-cell { aspect-ratio: 1; display: flex; align-items: center; justify-content: center; background: rgba(255,255,255,0.03); border-radius: 4px; }
        .dot { width: 6px; height: 6px; background-color: #475569; border-radius: 50%; }
        .pacman { 
            width: 22px; height: 22px; background: #fbbf24; border-radius: 50%; 
            position: relative; z-index: 10;
            box-shadow: 0 0 10px #fbbf24;
            animation: chomp 0.3s infinite alternate;
        }
        @keyframes chomp { from { clip-path: polygon(100% 0%, 100% 100%, 50% 50%); } to { clip-path: polygon(100% 20%, 100% 80%, 50% 50%); } }
        
        .input-dark {
            background: #1e293b; border: 1px solid #334155; color: white;
            transition: all 0.3s;
        }
        .input-dark:focus { border-color: #6366f1; outline: none; box-shadow: 0 0 0 2px rgba(99, 102, 241, 0.2); }
        
        /* æ»šåŠ¨æ¡ç¾åŒ– */
        ::-webkit-scrollbar { width: 6px; }
        ::-webkit-scrollbar-track { background: #1e293b; }
        ::-webkit-scrollbar-thumb { background: #475569; border-radius: 3px; }
    </style>
</head>
<body>

<div id="app" v-cloak class="min-h-screen p-4 max-w-4xl mx-auto pb-20">
    
    <!-- é¡¶éƒ¨é€šçŸ¥ -->
    <div v-if="msg" class="fixed top-4 left-1/2 -translate-x-1/2 z-50 px-4 py-2 rounded-lg shadow-xl text-sm font-bold flex items-center gap-2 transition-all duration-300"
         :class="msgType === 'success' ? 'bg-emerald-600 text-white' : 'bg-rose-600 text-white'">
        <i class="fas" :class="msgType === 'success' ? 'fa-check' : 'fa-exclamation-circle'"></i> {{ msg }}
    </div>

    <!-- å¤´éƒ¨ -->
    <header class="flex justify-between items-center mb-6">
        <div>
            <h1 class="text-2xl font-bold text-transparent bg-clip-text bg-gradient-to-r from-amber-400 to-orange-500">
                <i class="fas fa-ghost mr-2"></i>èº«æåƒè±†äºº
            </h1>
            <p class="text-xs text-slate-500 mt-1">
                <i class="fab fa-github"></i> äº‘ç«¯åŒæ­¥ + Excel å¯¼å…¥
            </p>
        </div>
        <div class="flex gap-2">
            <!-- éšè—çš„æ–‡ä»¶è¾“å…¥æ¡† -->
            <input type="file" ref="fileInput" @change="handleExcelUpload" accept=".xlsx, .xls, .csv" class="hidden">
            
            <button @click="$refs.fileInput.click()" :disabled="loading" class="bg-emerald-600 hover:bg-emerald-500 text-white px-3 py-2 rounded-lg text-sm font-bold transition flex items-center gap-2 shadow-lg shadow-emerald-900/20">
                <i class="fas fa-file-excel"></i> å¯¼å…¥Excel
            </button>

            <button @click="pullData" class="w-10 h-10 rounded-full bg-slate-800 hover:bg-slate-700 flex items-center justify-center transition" title="å¼ºåˆ¶åˆ·æ–°">
                <i class="fas fa-sync-alt text-slate-400" :class="{'fa-spin': loading}"></i>
            </button>
        </div>
    </header>

    <!-- ä¸»æ§å° -->
    <div class="grid grid-cols-1 md:grid-cols-12 gap-6">
        
        <!-- å·¦ä¾§ï¼šæ¸¸æˆåŒ–å±•ç¤º -->
        <div class="md:col-span-5 glass rounded-2xl p-6 flex flex-col items-center relative overflow-hidden">
            <!-- èƒŒæ™¯è£…é¥° -->
            <div class="absolute top-0 left-0 w-full h-1 bg-gradient-to-r from-indigo-500 via-purple-500 to-pink-500"></div>
            
            <div class="text-center mb-6">
                <p class="text-slate-400 text-xs uppercase tracking-wider mb-1">Current Weight</p>
                <div class="text-5xl font-bold text-white tracking-tight">{{ currentWeight }}<span class="text-lg text-slate-500 ml-1">kg</span></div>
            </div>

            <div class="pac-grid mb-6">
                <div v-for="n in 100" :key="n" class="pac-cell" :class="{'opacity-20': n < currentStep}">
                    <div v-if="n === currentStep" class="pacman"></div>
                    <div v-else-if="n === 100" class="fas fa-flag-checkered text-rose-500"></div>
                    <div v-else-if="n > currentStep" class="dot"></div>
                </div>
            </div>

            <div class="w-full flex justify-between text-sm px-4">
                <div class="text-center">
                    <div class="text-emerald-400 font-bold text-lg">{{ lostJin }}</div>
                    <div class="text-xs text-slate-500">å·²å‡ (æ–¤)</div>
                </div>
                <div class="text-center">
                    <div class="text-amber-400 font-bold text-lg">{{ progress }}%</div>
                    <div class="text-xs text-slate-500">è¿›åº¦</div>
                </div>
                <div class="text-center">
                    <div class="text-rose-400 font-bold text-lg">{{ remainJin }}</div>
                    <div class="text-xs text-slate-500">å‰©ä½™ (æ–¤)</div>
                </div>
            </div>
        </div>

        <!-- å³ä¾§ï¼šè¾“å…¥ä¸åˆ—è¡¨ -->
        <div class="md:col-span-7 flex flex-col gap-6">
            
            <!-- è¾“å…¥åŒº -->
            <div class="glass rounded-2xl p-5">
                <h3 class="text-sm font-bold text-slate-300 mb-3"><i class="fas fa-pen mr-2"></i>ä»Šæ—¥æ‰“å¡</h3>
                <div class="flex gap-2">
                    <input type="date" v-model="input.date" class="input-dark rounded px-3 py-2 text-sm w-1/3">
                    <input type="number" v-model.number="input.weight" placeholder="ä½“é‡" class="input-dark rounded px-3 py-2 text-sm w-1/3">
                    <input type="number" v-model.number="input.cost" placeholder="èŠ±è´¹" class="input-dark rounded px-3 py-2 text-sm w-1/3">
                </div>
                <button @click="addRecord" :disabled="loading" class="w-full mt-3 bg-indigo-600 hover:bg-indigo-500 text-white py-2 rounded font-bold transition flex justify-center items-center gap-2 shadow-lg shadow-indigo-900/50">
                    <i class="fas" :class="loading ? 'fa-spinner fa-spin' : 'fa-plus'"></i>
                    {{ loading ? 'æ­£åœ¨åŒæ­¥...' : 'è®°å½•å¹¶åŒæ­¥' }}
                </button>
            </div>

            <!-- å›¾è¡¨ -->
            <div class="glass rounded-2xl p-4 h-64 relative">
                <div id="chart" class="w-full h-full"></div>
                <div v-if="records.length === 0" class="absolute inset-0 flex items-center justify-center text-slate-500 text-sm">
                    ç­‰å¾…æ•°æ®åŒæ­¥...
                </div>
            </div>

            <!-- åˆ—è¡¨ -->
            <div class="glass rounded-2xl p-4 flex-1 overflow-hidden flex flex-col">
                <div class="flex justify-between items-center mb-2">
                    <h3 class="text-sm font-bold text-slate-300">å†å²è®°å½•</h3>
                    <span class="text-xs text-slate-500">{{ records.length }} æ¡</span>
                </div>
                <div class="overflow-y-auto max-h-48 pr-2 custom-scroll">
                    <table class="w-full text-sm text-left text-slate-400">
                        <thead>
                            <tr class="text-xs text-slate-600 border-b border-slate-800">
                                <th class="pb-2">æ—¥æœŸ</th>
                                <th class="pb-2">ä½“é‡</th>
                                <th class="pb-2 text-right">æ“ä½œ</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr v-for="(r, i) in sortedRecords" :key="i" class="border-b border-slate-800/50 hover:bg-slate-800/30 transition group">
                                <td class="py-2 font-mono text-slate-300">{{ r.date }}</td>
                                <td class="py-2 font-bold text-amber-400">{{ r.weight }}</td>
                                <td class="py-2 text-right">
                                    <button @click="deleteRecord(r)" class="text-slate-600 hover:text-rose-500 transition opacity-0 group-hover:opacity-100">
                                        <i class="fas fa-trash"></i>
                                    </button>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
    </div>

</div>

<script>
const { createApp } = Vue;

createApp({
    data() {
        return {
            loading: false,
            msg: '',
            msgType: 'info',
            // --- æ‚¨çš„ç§äººé…ç½® ---
            config: {
                token: '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', 
                gistId: 'bad89a736eb73d5165930e216d568ce4',       
                start: 80,
                target: 65
            },
            input: {
                date: new Date().toISOString().split('T')[0],
                weight: '',
                cost: ''
            },
            records: [],
            chart: null
        }
    },
    computed: {
        sortedRecords() {
            return [...this.records].sort((a, b) => new Date(b.date) - new Date(a.date));
        },
        timelineRecords() {
            return [...this.records].sort((a, b) => new Date(a.date) - new Date(b.date));
        },
        currentWeight() {
            return this.records.length ? this.timelineRecords[this.timelineRecords.length-1].weight : this.config.start;
        },
        lostJin() {
            return ((this.config.start - this.currentWeight) * 2).toFixed(1);
        },
        remainJin() {
            let v = (this.currentWeight - this.config.target) * 2;
            return v > 0 ? v.toFixed(1) : 0;
        },
        progress() {
            const total = this.config.start - this.config.target;
            const lost = this.config.start - this.currentWeight;
            if(total <= 0) return 100;
            let p = (lost / total) * 100;
            return Math.min(100, Math.max(0, p)).toFixed(1);
        },
        currentStep() {
            return Math.floor(this.progress);
        }
    },
    mounted() {
        this.pullData();
        this.$nextTick(() => this.initChart());
        window.addEventListener('resize', () => this.chart && this.chart.resize());
    },
    methods: {
        notify(text, type='success') {
            this.msg = text;
            this.msgType = type;
            setTimeout(() => this.msg = '', 3000);
        },

        // --- Excel å¯¼å…¥é€»è¾‘ ---
        handleExcelUpload(event) {
            const file = event.target.files[0];
            if (!file) return;

            this.notify('æ­£åœ¨è§£æ Excel...', 'info');
            this.loading = true;

            const reader = new FileReader();
            reader.onload = (e) => {
                try {
                    const data = e.target.result;
                    const workbook = XLSX.read(data, { type: 'binary' });
                    const firstSheet = workbook.Sheets[workbook.SheetNames[0]];
                    const rows = XLSX.utils.sheet_to_json(firstSheet, { header: 1 });

                    // å¯»æ‰¾è¡¨å¤´ç´¢å¼•
                    let dateIdx = -1, weightIdx = -1, costIdx = -1;
                    let headerRowIndex = 0;

                    // ç®€å•çš„è¡¨å¤´æŸ¥æ‰¾é€»è¾‘
                    for(let i=0; i<Math.min(5, rows.length); i++) {
                        const rowStr = rows[i].join(' ').toLowerCase();
                        if(rowStr.includes('date') || rowStr.includes('æ—¥æœŸ')) {
                            headerRowIndex = i;
                            rows[i].forEach((cell, idx) => {
                                const txt = String(cell).trim().toLowerCase();
                                if(txt.includes('date') || txt.includes('æ—¥æœŸ')) dateIdx = idx;
                                if(txt.includes('weight') || txt.includes('ä½“é‡')) weightIdx = idx;
                                if(txt.includes('cost') || txt.includes('èŠ±è´¹')) costIdx = idx;
                            });
                            break;
                        }
                    }

                    if(dateIdx === -1 || weightIdx === -1) {
                        throw new Error('æœªæ‰¾åˆ°"æ—¥æœŸ"æˆ–"ä½“é‡"åˆ—ï¼Œè¯·æ£€æŸ¥è¡¨å¤´');
                    }

                    let importCount = 0;
                    const newMap = new Map();
                    
                    // 1. å…ˆæŠŠç°æœ‰è®°å½•æ”¾å…¥ Map (Key=Date)
                    this.records.forEach(r => newMap.set(r.date, r));

                    // 2. éå† Excel æ•°æ®å¹¶è¦†ç›–/æ–°å¢
                    for(let i = headerRowIndex + 1; i < rows.length; i++) {
                        const row = rows[i];
                        if(!row[dateIdx]) continue;

                        const dateStr = this.parseExcelDate(row[dateIdx]);
                        const weightVal = parseFloat(row[weightIdx]);

                        if(dateStr && !isNaN(weightVal)) {
                            const record = {
                                date: dateStr,
                                weight: weightVal,
                                cost: costIdx !== -1 ? (parseFloat(row[costIdx]) || 0) : 0
                            };
                            newMap.set(dateStr, record); // æ ¸å¿ƒï¼šMapä¼šè‡ªåŠ¨è¦†ç›–ç›¸åŒKey(æ—¥æœŸ)çš„æ•°æ®
                            importCount++;
                        }
                    }

                    // 3. è½¬å›æ•°ç»„
                    this.records = Array.from(newMap.values());
                    
                    this.notify(`è§£ææˆåŠŸï¼æ›´æ–°äº† ${importCount} æ¡æ•°æ®ï¼Œæ­£åœ¨ä¸Šä¼ ...`);
                    this.initChart();
                    
                    // 4. è‡ªåŠ¨ä¸Šä¼ åˆ° GitHub
                    this.pushData();

                } catch (err) {
                    console.error(err);
                    this.notify(err.message, 'error');
                    this.loading = false;
                } finally {
                    // æ¸…ç©º input å…è®¸é‡å¤ä¸Šä¼ åŒä¸€æ–‡ä»¶
                    event.target.value = '';
                }
            };
            reader.readAsBinaryString(file);
        },

        // Excel æ—¥æœŸè§£æé»‘é­”æ³•
        parseExcelDate(val) {
            if (!val) return null;
            // å¦‚æœæ˜¯ Excel åºåˆ—å· (ä¾‹å¦‚ 45230)
            if (typeof val === 'number' && val > 20000) {
                const date = new Date((val - 25569) * 86400 * 1000);
                return date.toISOString().split('T')[0];
            }
            // å¦‚æœæ˜¯å­—ç¬¦ä¸²
            const date = new Date(String(val).replace(/\//g, '-').replace(/\./g, '-'));
            if (isNaN(date.getTime())) return null;
            return date.toISOString().split('T')[0];
        },

        // --- GitHub Gist API ---
        async pullData() {
            this.loading = true;
            try {
                const res = await fetch(`https://api.github.com/gists/${this.config.gistId}`, {
                    headers: { 'Authorization': `token ${this.config.token}` },
                    cache: 'no-store'
                });
                if(!res.ok) throw new Error('è¿æ¥å¤±è´¥');
                const data = await res.json();
                const file = data.files['data.json'];
                this.records = file ? JSON.parse(file.content) : [];
                this.notify('äº‘ç«¯æ•°æ®å·²åŒæ­¥');
                this.initChart();
            } catch(e) {
                this.notify(e.message, 'error');
            } finally {
                this.loading = false;
            }
        },

        async pushData() {
            this.loading = true;
            try {
                const payload = { files: { "data.json": { content: JSON.stringify(this.records, null, 2) } } };
                const res = await fetch(`https://api.github.com/gists/${this.config.gistId}`, {
                    method: 'PATCH',
                    headers: {
                        'Authorization': `token ${this.config.token}`,
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify(payload)
                });
                if(!res.ok) throw new Error('ä¸Šä¼ å¤±è´¥');
                this.notify('å·²è‡ªåŠ¨ä¿å­˜åˆ°äº‘ç«¯');
            } catch(e) {
                this.notify(e.message, 'error');
            } finally {
                this.loading = false;
            }
        },

        // --- åŸºç¡€ä¸šåŠ¡ ---
        async addRecord() {
            if(!this.input.weight) return this.notify('è¯·è¾“å…¥ä½“é‡', 'error');
            const idx = this.records.findIndex(r => r.date === this.input.date);
            const newRecord = { date: this.input.date, weight: this.input.weight, cost: this.input.cost || 0 };
            if(idx > -1) this.records[idx] = newRecord;
            else this.records.push(newRecord);
            this.initChart();
            await this.pushData();
        },

        async deleteRecord(record) {
            if(!confirm('ç¡®å®šåˆ é™¤?')) return;
            this.records = this.records.filter(r => r !== record);
            this.initChart();
            await this.pushData();
        },

        initChart() {
            const dom = document.getElementById('chart');
            if(!dom || !this.chart && !(this.chart = echarts.init(dom))) return;
            const data = this.timelineRecords;
            this.chart.setOption({
                grid: { top: 20, right: 20, bottom: 20, left: 40, containLabel: true },
                tooltip: { trigger: 'axis', backgroundColor: 'rgba(30,41,59,0.9)', borderColor: '#475569', textStyle: {color:'#fff'} },
                xAxis: { type: 'category', data: data.map(r => r.date), axisLine: { lineStyle: { color: '#475569' } } },
                yAxis: { type: 'value', scale: true, splitLine: { lineStyle: { color: '#334155', type: 'dashed' } }, axisLabel: { color: '#94a3b8' } },
                series: [{
                    data: data.map(r => r.weight),
                    type: 'line',
                    smooth: true,
                    symbolSize: 8,
                    itemStyle: { color: '#fbbf24' },
                    lineStyle: { width: 3, color: '#fbbf24' },
                    areaStyle: { color: new echarts.graphic.LinearGradient(0, 0, 0, 1, [{ offset: 0, color: 'rgba(251, 191, 36, 0.3)' }, { offset: 1, color: 'rgba(251, 191, 36, 0)' }]) }
                }]
            });
        }
    }
}).mount('#app');
</script>
</body>
</html>
```
